wha is service ?

in kubernetes service is used for inter pod communication

why do we need service instead we can communicate with pod ip?

- we know pod is ephemeral . any time it can restart. we also know pod cannot heal. if a pod affected it's died. and create another pod instead of previous pod. for this behaivor a pod's ip also change. so there is a issue to communicate with that pod. why we need services.

frontend -> service -> backend

service abstract a set of pods

imparative service create -

```sh
    kubectl expose deployment -n namespace-here deployment-name  --port 8080--dry-run -oyaml > service.yaml
```

```sh
    kubectl get endpoints -n namespace
```

```sh
    kubectl scale deployment -n namespace deployment-name --replicas 2
```

service controller scans the pods that are matching the label that is define in the service and then adds the ips of those pod into the service (see endpoints inside service)

```yaml
spec:
  ports:
    - port: 8080
      protocol: TCP
      targetPort: 8080 / port_name (see deployment/ pods we add port with name there v) # preffered use port_name
```

we can create service without `selector` field. sometimes we need to create .then we have to set the endpoints manually. why it's useful. bcz sometimes we need to access outside things that are not managed by kubernetes. we have set those endpoints inside service manually so that service can handle it.

how can I access the services ?

two ways: 1. environment variable 2. using dns

environtment variable:
first we create service. then create pod. then `kubelet` is going to set the environment variable in pod (whos matched the lables) for this service

wanna see prove?

exect the pod
then write `env` then you can see `RESTAPI_SERVICE_HOST`, `RESTAPI_SERVICE_PORT`

using DNS: we should not use first things. bcz it has drawbacks. we have to maintain the procedure (first create service then create job). recommend to use sing DNS

how can we access : (requirement dns (coredns) server should be install in cluster. otheriwise this dns whould not resolved)

`service_name.namespace_name.svc.cluster.local`

### kinds of services and their usecase

1. ClusterIP - dns way / env variable (use case : pod to pod communication)

2. NodePort - if service type NodePort . we can access the service using `Nodes` IP. ( use case : expose our service outside the cluster). ex: nodeIpd:port(randomly generated by the kubernetes (see the svc you can see a random generated alongside the `Ports` section))

3. LoadBalancer - when we expose the workload outside the cluster.

4. ExternalName - use case: you want to redirect/ you want to resolve specific dns (ex: resolve 'abc-website' to 'abc.dev')
